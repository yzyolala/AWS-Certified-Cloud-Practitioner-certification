## 为什么要制作一个全球应用程序？

一个全球应用程序是部署在多个地理位置的应用程序

在AWS上：这可能是区域和/或边缘位置

### 减少延迟

延迟是网络数据包到达服务器所需的时间

从亚洲到美国传输数据包需要一些时间

部署您的应用程序更靠近您的用户以减少延迟，提供更好的体验

### 灾难恢复（DR）

如果AWS区域因地震、风暴、停电、政治等原因宕机...

您可以故障转移到另一个区域，并保持您的应用程序仍在运行

灾难恢复计划对提高应用程序的可用性非常重要

攻击保护：分布式全球基础设施更难以攻击

## Route 53 ：

是 AWS 提供的一项托管的域名系统（DNS）服务，具有多种功能，包括域名注册、DNS解析、健康检查和路由策略。以下是对 Route 53 功能的概述：

### 域名注册：

Route 53 允许用户注册新的域名，这些域名可以用于网站、应用程序等。AWS 通过 Route 53 提供了广泛的顶级域名（TLD）选择，如.com、.net、.org 等。

### DNS解析：

Route 53 作为 DNS 服务器，负责将域名解析为相应的 IP 地址。它支持不同类型的 DNS 记录，包括 A 记录（IPv4 地址解析）、AAAA 记录（IPv6 地址解析）、CNAME 记录（主机名到主机名的别名）、别名记录（指向 AWS 资源，如 ELB、CloudFront、S3、RDS 等）等。

### 健康检查：

Route 53 提供了健康检查功能，可以定期检查终端节点（例如 Web 服务器）的可用性。如果一个节点被标记为不可用，Route 53 可以自动将流量路由到其他健康的节点，从而提高可用性和容错性。

### 路由策略:

简单路由策略：直接将流量路由到指定的终端节点，不涉及健康检查或复杂的权重设置。

加权路由策略：根据设置的权重分配流量到不同的终端节点，使用户能够控制流量的分配比例。

延迟路由策略：根据不同终端节点的延迟时间来选择最佳路由，以提高用户体验。

故障转移路由策略：用于灾难恢复，根据健康检查结果切换流量到主服务器和故障转移（备用）服务器之间，以确保服务的持续可用性。

## CloudFront：

提高性能：CloudFront通过将内容缓存在全球各个**边缘位置**来提高读取性能，从而减少了用户访问内容时的延迟，提升了用户体验。

全球覆盖：**以最小的延迟在全球范围内传递图像和视频。**

安全性：CloudFront提供DDoS攻击防护，并与**Shield和WAF集成**，以帮助保护您的应用程序免受网络攻击。

### CloudFront的源点（Origins）两种类型：

#### S3 Bucket：

**可加快向用户分发静态和动态 Web 内容（例如 .html、.css、.js 和图像文件）的速度。**

您可以将Amazon S3存储桶作为CloudFront的源点，用于分发文件并在边缘位置进行缓存。指出了公共互联网用户和AWS云内的私有用户之间的交互。

为增强安全性，您可以使用CloudFront Origin Access Control (OAC)来限制谁可以访问您的内容。

#### 自定义源点（HTTP）：

应用程序负载均衡器、EC2实例、S3网站（前提是必须将存储桶启用为静态网站）以及任何您想要的HTTP后端服务。

### CloudFront与S3跨区域复制区别：

CloudFront是一个全球边缘网络，文件被缓存一定的时间（TTL，可能是一天），非常适合必须随处可用的静态内容。

S3跨区域复制需要为每个要复制的区域进行设置，文件在近乎实时内更新，仅为只读，适合需要在少数区域内低延迟可用的动态内容

## Global Accelerator：

**使用AWS全球网络**提高应用程序的可用性、性能和安全性

它通过AWS内部网络优化应用程序的路由，可以提高性能达60%。

为应用程序创建了两个Anycast IP地址，流量通过边缘位置发送。

边缘位置将流量发送到应用程序。

**对于需要确定性和快速区域故障转移的用例也很有用**

## Global Accelerator和CloudFront。

两者都使用AWS全球网络及其在全球的边缘位置。

这两项服务都与AWS Shield集成，以获得DDoS保护。

### CloudFront：

是一个内容交付网络（CDN），它提高了可**缓存内容**（如图片和视频）的性能，内容在**边缘位置**提供。

### Global Accelerator：

**不进行缓存**或代理包，而是直接将数据包传输到运行在一个或多个AWS区域的应用程序

适用于需要静态IP地址的HTTP用例，**对于需要确定性和快速区域故障转移的用例也很有用** ，这个过程是通过公共网络和AWS的私有网络实现加速的。

## Outposts：

**提供了一种混合云解决方案，使您能够在本地运行AWS基础架构和服务，同时与AWS云无缝连接。**

**该服务将AWS生态系统扩展到您的本地位置，使您能够充分利用云的优势，同时满足混合环境中的数据存储、低延迟应用程序和特定监管需求。**

用户对Outposts服务器架的物理安全负责。

好处包括低延迟访问本地系统，本地数据处理，数据驻留，从本地到云的迁移更简单，以及完全托管服务。

支持在Outposts上运行的AWS服务包括Amazon EC2, Amazon EBS, Amazon S3, Amazon EKS, Amazon ECS, Amazon RDS, 和Amazon EMR。

## S3传输加速：

用于提升文件从一个地理位置传输到S3存储桶的速度的服务。

它工作的方式是通过将文件首先传输到用户最近的AWS边缘位置，然后从那里快速传输到最终目的地的S3存储桶。

## Wavelength：

AWS Wavelength是设计用来将AWS服务带到**5G网络**边缘的一种服务，目的是为了减少延迟和提高移动和边缘设备的应用性能。

它通过在电信提供商的数据中心内创建Wavelength Zones来实现，这些Zones嵌入在5G网络的边缘。

Wavelength支持的服务例如EC2, EBS, VPC等，旨在通过5G网络提供超低延迟应用。

数据流量不会离开通信服务提供商（CSP）的网络。

Wavelength提供了高带宽和安全连接到父AWS区域。

使用Wavelength服务不会产生额外费用或服务协议。

使用案例包括智能城市，机器学习辅助诊断，联网汽车，互动直播视频流，增强/虚拟现实，实时游戏等。

## Local Zones：

旨在将AWS的计算、存储、数据库和其他选定服务更靠近最终用户，以运行对延迟敏感的应用程序。

它允许将您的虚拟私有云（VPC）扩展到更多位置，被称为AWS区域的“扩展”。

Local Zones与EC2、RDS、ECS、EBS、ElastiCache、Direct Connect等服务兼容。

例如，AWS区域可以是北弗吉尼亚（us-east-1），而AWS Local Zones可以包括波士顿、芝加哥、达拉斯、休斯顿、迈阿密等城市。

## 全球应用程序架构的不同设计模式

### 单区域单可用性区（Single Region, Single AZ）:

这个架构位于一个AWS区域内的单个可用性区。

它没有高可用性，因为如果那个单一的可用性区出现故障，服务将不可用。

有高全球延迟，因为所有的请求都需要被路由到这个单一的位置。

这种架构的复杂性较低，适用于对高可用性要求不高的应用。

### 单区域多可用性区（Single Region, Multi AZ）:

这个架构在同一个区域内跨多个可用性区部署EC2实例。

提供高可用性，如果一个可用性区出现故障，其他的可以继续提供服务。

依然有全球延迟的问题，因为所有的请求仍然需要被路由到这个单一的区域。

### 多区域活动-被动（Multi Region, Active-Passive）:

这个架构在两个不同的区域内部署了服务，一个区域是活动的（处理读写操作），另一个是被动的（只处理读操作）。

它对于全球读操作延迟提供了改善，但写操作延迟仍然是一个问题。

这种架构的难度较高，因为它涉及到数据的复制和一致性问题。

### 多区域活动-活动（Multi Region, Active-Active）:

这个架构在两个或多个区域中都有活动状态的EC2实例。

它提供了更好的读写延迟性能，因为用户可以与最近的区域交互。

这种架构的复杂性最高，因为它需要同步多个区域之间的数据和操作。

## 多区域对比

多个AWS区域：这意味着将EC2实例分布在不同的AWS区域，以确保地理上的冗余和高可用性。这是一种常见的**高可用性策略**，因为它在不同的地理位置提供了冗余。

多个Amazon CloudFront位置：Amazon CloudFront是一项内容分发服务，用于将内容传送到全球各地的边缘位置。这个选项可能不适用于实现高度可用性的要求，因为它**主要与内容分发有关，而不是EC2实例的高可用性**

多个边缘位置：AWS的边缘位置通常用于**内容分发和加速**，而不是用于实现高度可用性

AWS本地区域（Local Zones）：AWS本地区域是AWS云的扩展，通常位于大城市附近。它们可以**提供更接近用户的计算资源**，但通常不用于实现地理上的冗余和高可用性。

## 总结

Route 53 — 负责将用户路由到延迟最低的部署，对于灾难恢复策略很有用。

CDN CloudFront — 将应用程序的一部分复制到AWS的边缘位置，缓存常见请求以减少延迟，改善用户体验。

S3 Transfer Acceleration — 加速全球上传和下载到Amazon S3。

Global Accelerator — 使用AWS全球网络改善全球应用程序的可用性和性能。

Outposts — 在自己的数据中心部署Outposts Rack扩展AWS服务

Wavelength — 将AWS服务带到5G网络的边缘，适用于超低延迟应用程序。

Local Zones — 将AWS资源（计算、数据库、存储等）带到用户更近的地方，适合对延迟敏感的应用程序。
