## AWS中的IP地址：

IPv4，拥有约43亿个地址的限制。

**公共IPv4**，可用于互联网。

EC2实例每次停止和启动时都会获得一个新的公共IPv4地址。

**私有IPv4**，用于像局域网（LAN）这样的私有网络。

对于EC2实例，私有IPv4是固定的，即使它们被启动或停止也是如此。

弹性IP是一个固定的公共IPv4地址，可以附加到EC2实例，注意如果没有附加到EC2实例或者EC2实例停止了，它会产生持续的费用。

IPv6是最新版本的互联网协议，具有显着更大的地址空间。

## VPC：

VPC是部署资源的私有网络，是一个区域性资源。

子网允许您在VPC内分区您的网络，并与可用性区域绑定。

公共子网是可以从互联网访问的子网。

私有子网是无法从互联网访问的子网。

路由表用于定义对互联网和子网之间的访问。

## 互联网网关和NAT网关

互联网网关帮助我们的VPC实例连接到互联网。

公共子网有一条路由到互联网网关。

NAT网关（AWS管理）和NAT实例（自我管理）允许你的实例在你的私有子网中访问互联网，同时保持私有。

## 网络ACL和安全组

**网络ACL（Network ACL）**:

一个控制进出子网流量的防火墙。

可以有允许（ALLOW）和拒绝（DENY）规则。

附加在子网级别。

规则只包括IP地址。

**安全组:**

一个控制进出ENI/EC2实例流量的防火墙。

只能有允许（ALLOW）规则。

规则包括IP地址和其他安全组。

## 安全组vs网络访问控制列表（NACL）

| 安全组 (Security Group) | 网络ACL (Network ACL) |
|------------------------|----------------------|
| 在实例级别运行。               | 在子网级别运行。          |
| 只支持允许规则。               | 支持允许和拒绝规则。        |
| 是有状态的：无论任何规则，返回流量都会自动被允许。 | 是无状态的：返回流量必须明确地通过规则被允许。 |

## VPC流日志：

VPC流日志可以捕获进入接口的IP流量信息，例如VPC流日志、子网流日志和弹性网络接口流日志。

它们有助于监控和排除连接性问题，比如从子网到互联网、子网到子网、互联网到子网的连接。

它们还能捕获来自AWS管理接口的网络信息，例如弹性负载均衡器、ElastiCache、RDS、Aurora等。

VPC流日志数据可以被发送到S3、CloudWatch日志和Kinesis Data Firehose。

## VPC对等连接：

VPC对等连接可以将两个VPC私密地连接在AWS网络中。

这样可以让它们行为表现得像在同一个网络中一样。

两个VPC不能有重叠的CIDR（IP地址范围）。

VPC对等连接不是传递性的，每个需要互相通信的VPC都必须建立一个对等连接。

## VPC端点：

端点允许你使用私有网络而非公共WWW网络连接到AWS服务。

这为你提供了增强的安全性和访问AWS服务的更低延迟。

VPC端点网关支持S3和DynamoDB。

VPC端点接口支持其他服务。

## PrivateLink（VPC端点服务）：

是一种安全且可扩展的方式，用于向数千个VPC公开服务。

它不需要VPC对等连接、互联网网关、NAT或路由表。

需要一个网络负载均衡器（服务VPC）和一个弹性网络接口（客户VPC）。

## 站点到站点VPN和Direct Connect：

站点到站点VPN连接一个本地VPN到AWS，连接会自动加密，并且通过公共互联网。

Direct Connect（DX）建立一个物理连接在本地和AWS之间，这个连接是私有的、安全的、快速的，并且通过一个私有网络，至少需要一个月来建立。

## 站点到站点VPN：

本地端必须使用一个客户网关（CGW）。

AWS端必须使用一个虚拟私有网关（VGW）。

## 客户端VPN：

可以使用OpenVPN从你的电脑连接到AWS和本地的私有网络。

允许你通过私有IP连接到你的EC2实例，就好像你在私有VPC网络中一样。

连接是通过公共互联网进行的。

## 中转网关transit gateway：

用于在数千个VPC和本地之间实现有传递性的对等连接，使用集线式拓扑（hub-and-spoke）。

只需要一个网关就可以提供这个功能。

它可以和Direct Connect网关、VPN连接一起工作。

## 总结：

VPC：虚拟私有云。

子网：绑定到一个可用区（AZ），是VPC的网络分区。

互联网网关：在VPC层面提供互联网访问。

NAT网关/实例：为私有子网提供互联网访问。

NACL：无状态的，子网级别的入站和出站规则。

安全组：有状态的，在EC2实例层面或ENI运作。

VPC对等连接：连接两个VPC，使用非重叠的IP范围。

弹性IP：固定的公共IPv4地址，如果不使用会持续产生费用。

VPC端点：在VPC内提供对AWS服务的私有访问。

PrivateLink：在第三方VPC中私密地连接到服务。

VPC流日志：网络流量日志。

站点到站点VPN：在本地数据中心和AWS之间通过公共互联网的VPN。

客户端VPN：从你的电脑到你的VPC的OpenVPN连接。

Direct Connect：直接私有连接到AWS。

中转网关：连接数千个VPC和本地网络。

